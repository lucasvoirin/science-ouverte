---
title: "Vraisemblablement..."
author: "Lucas"
date: "2024-03-23"
categories: [Statistiques, üí°]
image: "vraisemblance.png"
---

### Un atterrissage forc√©

Suite √† un probl√®me technique, notre navette spatiale doit s'arr√™ter en urgence sur la plan√®te la plus proche. Un rapide examen de l'ordinateur de bord indique que c'est le syst√®me de localisation qui est tomb√© en panne. Malheureusement, c'est impossible de repartir sans lui. Nous sommes clou√©s au sol, sans savoir sur quelle plan√®te nous venons d'atterrir.

Notre capitaine de bord n'est pas trop inquiet, il s'empresse d'appeler l'assistance remorquage spatial qui viendra, sans aucun doute, nous chercher d'ici quelques jours au plus tard. Mais sa confiance retombe vite : l'assistance lui demande le nom de la plan√®te sur laquelle nous nous trouvons, sans quoi elle ne pourra jamais r√©ussir √† nous localiser.

Nous sommes bel et bien coinc√©s ici.

### Des roses rouges, des roses blanches

C'est alors que la botaniste de l'√©quipe a une id√©e. Il existe sur chaque plan√®te de la galaxie une esp√®ce de rose rouge, mais dont certaines fleurs sont enti√®rement blanches. Ce qui est int√©ressant, c'est que chaque plan√®te poss√®de une proportion de fleurs blanches qui lui est propre.

En botaniste confirm√©e, notre co√©quipi√®re prom√®ne toujours dans son sac un gros livre sur les plantes √† fleurs de la galaxie. Et dans son livre est inscrite la liste de toutes les plan√®tes du syst√®me avec pour chacune d'entre elles la proportion de fleurs blanches chez notre esp√®ce de rose.


### Nos donn√©es : un bouquet de roses !

Le plan est le suivant : nous allons r√©colter un √©chantillon al√©atoire de 10 roses et compter le nombre de fleurs blanches parmi les rouges. Nous obtenons ainsi 6 roses rouges et 4 roses blanches. Ces chiffres, ce sont nos donn√©es. Pour faciliter le traitement de l'information nous utilisons l'ordinateur de bord qui, comme dans tous les vaisseaux spatiaux, est √©quip√© du logiciel $\textsf{R}$.

Voici comment nous rentrons les donn√©es :

```{r}
white = 4
total = 10
```

### Notre th√©orie : serions-nous sur Tatooine ?

Notre capitaine de bord, s√ªr de lui, √©met une th√©orie selon laquelle nous serions arriv√©s sur la plan√®te Tatooine. Selon le livre des plantes de la galaxie, Tatooine poss√®de une proportion de fleurs blanches de `O.8`.

On entre cette th√©orie dans $\textsf{R}$ de la fa√ßon suivante :

```{r}
Tatooine = 0.8
```

Il nous faut maintenant d√©terminer si les donn√©es sont vraissemblables selon cette th√©orie.

### La vraisemblance de nos donn√©es

Ici, la vraisemblance (en anglais on dit "likelihood") de nos donn√©es, c'est la probabilit√© d'avoir r√©colt√© un √©chantillon semblable au notre, en consid√©rant que nous sommes effectivement sur Tatooine, o√π la proportion de fleurs blanches est de `0.8`.

Autrement dit, on peut se poser la question : si nous sommes sur Tatooine, √† quel point est-ce probable d'avoir r√©colt√© 4 fleurs blanches sur un total de 10 fleurs r√©colt√©es ?

√áa tombe bien, dans $\textsf{R}$, c'est tr√®s facile de calculer cette probabilit√©. Il suffit d'utiliser la fonction `dbinom()` !

```{r}
likelihood = dbinom(
  x    = white,    # 4
  size = total,    # 10
  prob = Tatooine  # 0.8
)
```

On peut d√©sormais connaitre la probabilit√© d'avoir r√©colt√© 4 fleurs blanches sur 10 si nous sommes sur Tatooine !

```{r}
print(likelihood)
```

Aye ! La vraissemblance est toute petite : peine `{r} paste(round(likelihood*100, 1), "%")` de chance ! Cela signifie que si nous sommes sur Tatooine, √ßa serait tr√®s improbable d'avoir r√©colt√© un √©chantillon comme le notre !

### D'autres th√©ories

Ne nous avouons pas vaincus ! M√™me si nos donn√©es ne sont pas vraisemblables avec notre premi√®re th√©orie, nous avons plein d'autres th√©ories √† tester. Rappelez-vous, gr√¢ce au livre de botanique, nous connaissons les proportions de fleurs blanches pour chaque plan√®te de la galaxie.

Commen√ßons par rentrer dans $\textsf{R}$ chacune des plan√®tes de la liste et la proportion de fleurs blanches associ√©e :

```{r}
Coruscant = 0
Naboo     = 0.1
Mustafar  = 0.2
Kamino    = 0.3
Exegol    = 0.4
Crait     = 0.5
Corellia  = 0.6
Dagobah   = 0.7
Tatooine  = 0.8
Geonosis  = 0.9
Endor     = 1
```

Elles sont class√©es de celle qui a la plus petite proportion de fleurs blanches (Coruscant n'a aucune fleur blanche) √† celle qui a la plus grande proportion de fleurs blanches (Endor n'a que des fleurs blanches). Au total, nous avons 11 plan√®tes, soit 11 th√©ories possibles.

Nous allons de nouveau utiliser la fonction `dbinom()` pour calculer la vraisemblance de nos donn√©es selon chacune des th√©ories.

Pour √©viter de calculer les vraisemblances une √† une, dans $\textsf{R}$, on va cr√©er un vecteur pour grouper toutes les th√©ories :

```{r}
theories = c(
  Coruscant,
  Naboo,
  Mustafar,
  Kamino,
  Exegol,
  Crait,
  Corellia,
  Dagobah,
  Tatooine,
  Geonosis,
  Endor
)
```

Nous avons d√©sormais une suite de valeurs repr√©sentant nos 11 th√©ories :

```{r}
print(theories)
```

### Alors ? O√π sommes nous ?

Il ne nous reste qu'√† calculer les vraisemblances pour toutes les th√©ories :

```{r}
likelihoods = dbinom(
  x    = white,    # 4
  size = total,    # 10
  prob = theories  # de 0 √† 1
)
```

Le r√©sultat est une suite de vraisemblances. Chaque valeur repr√©sente la probabilit√© de r√©colter un √©chantillon comme le notre (de 4 fleurs blanches sur 10 fleurs r√©colt√©es) en fonction de la plan√®te sur laquelle on se trouve. Plus la probabilit√© est grande, plus on a de chance que notre √©chantillon soit issu de la plan√®te.

```{r}
print(round(likelihoods, 2))
```

Bon, pour y voir plus clair, faisons un graphique !

```{r}
#| echo: false

planets = c(
  "Coruscant ( 0 )",
  "    Naboo (0.1)",
  " Mustafar (0.2)",
  "   Kamino (0.3)",
  "   Exegol (0.4)",
  "    Crait (0.5)",
  " Corellia (0.6)",
  "  Dagobah (0.7)",
  " Tatooine (0.8)",
  " Geonosis (0.9)",
  "    Endor ( 1 )"
)

par(mar = c(8.1, 4.1, 4.1, 4.1))

barplot(likelihoods ~ c(1:11),
        names.arg = planets,
        xlab = "",
        ylab = "Vraisemblance de nos donn√©es",
        las = 2,
        )
```

Avec ce graphique on voit bien que la probabilit√© d'avoir r√©colt√© un √©chantillon de roses semblable au n√¥tre est la plus √©lev√©e si nous sommes sur Exegol. Nous pouvons donner cette information √† l'assistance remorquage spatial ! On peut √©galement leur transmettre l'information que la probabilit√© d'avoir un √©chantillon semblable au notre est assez √©lev√©e sur Kamino et Crait. Par contre la vraissemblance de nos donn√©es selon la th√©orie que l'on soit sur Coruscant ou Endor est nulle. Pas la peine que l'assistance nous cherche sur ces deux plan√®tes !
